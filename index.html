<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced TODO List</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body {
  background: #f4f6f8;
  transition: 0.3s;
}
.dark-mode {
  background: #121212;
  color: #fff;
}
.todo-card {
  max-width: 600px;
  margin: auto;
  border-radius: 12px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.1);
}
.dark-mode .todo-card {
  background: #1f1f1f;
}

/* ‚úÖ FIX: Title visible in dark mode */
.dark-mode h3 {
  color: #ffffff;
}

.task-row {
  transition: transform 0.2s, background 0.2s;
  cursor: grab;
}
.task-row:hover {
  background: rgba(255,255,255,0.08);
  transform: scale(1.01);
}
.completed {
  text-decoration: line-through;
  color: gray;
}
button {
  transition: transform 0.2s;
}
button:hover {
  transform: scale(1.05);
}
</style>
</head>

<body>

<div class="container py-4">
  <div class="card todo-card p-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h3>üìù My TODO List</h3>
      <button class="btn btn-sm btn-secondary" onclick="toggleDark()">üåô</button>
    </div>

    <form id="form" class="d-flex gap-2 mb-3">
      <input id="taskInput" class="form-control" placeholder="Enter task..." />
      <button class="btn btn-primary" id="submitBtn">Add</button>
    </form>

    <div class="btn-group mb-3 w-100">
      <button class="btn btn-outline-secondary" onclick="setFilter('all')">All</button>
      <button class="btn btn-outline-success" onclick="setFilter('completed')">Completed</button>
      <button class="btn btn-outline-warning" onclick="setFilter('pending')">Pending</button>
    </div>

    <table class="table table-sm align-middle text-center">
      <thead>
        <tr>
          <th>#</th>
          <th>Task</th>
          <th>Status</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>
</div>

<script>
let tasks = [
  { text: "Brush", done: false },
  { text: "Breakfast", done: false },
  { text: "College", done: true }
];

let editIndex = null;
let filter = "all";

const form = document.getElementById("form");
const input = document.getElementById("taskInput");
const tbody = document.getElementById("tbody");
const btn = document.getElementById("submitBtn");

function render() {
  tbody.innerHTML = "";

  tasks
    .filter(t => filter === "all" || (filter === "completed" && t.done) || (filter === "pending" && !t.done))
    .forEach((task, index) => {
      const tr = document.createElement("tr");
      tr.className = "task-row";
      tr.draggable = true;

      tr.innerHTML = `
        <td>${index + 1}</td>
        <td class="${task.done ? 'completed' : ''}">${task.text}</td>
        <td>
          <input type="checkbox" ${task.done ? "checked" : ""} onchange="toggleDone(${index})">
        </td>
        <td>
          <button class="btn btn-sm btn-warning" onclick="editTask(${index})">Edit</button>
          <button class="btn btn-sm btn-danger" onclick="deleteTask(${index})">Delete</button>
        </td>
      `;

      addDragEvents(tr, index);
      tbody.appendChild(tr);
    });
}

form.addEventListener("submit", e => {
  e.preventDefault();
  const value = input.value.trim();
  if (!value) return;

  if (editIndex === null) {
    tasks.push({ text: value, done: false });
  } else {
    tasks[editIndex].text = value;
    editIndex = null;
    btn.innerText = "Add";
  }

  input.value = "";
  render();
});

function deleteTask(i) {
  tasks.splice(i, 1);
  render();
}

function editTask(i) {
  input.value = tasks[i].text;
  editIndex = i;
  btn.innerText = "Update";
}

function toggleDone(i) {
  tasks[i].done = !tasks[i].done;
  render();
}

function setFilter(f) {
  filter = f;
  render();
}

function toggleDark() {
  document.body.classList.toggle("dark-mode");
}

// Drag & Drop
let dragIndex;
function addDragEvents(row, index) {
  row.addEventListener("dragstart", () => dragIndex = index);
  row.addEventListener("dragover", e => e.preventDefault());
  row.addEventListener("drop", () => {
    const temp = tasks[dragIndex];
    tasks[dragIndex] = tasks[index];
    tasks[index] = temp;
    render();
  });
}

render();
</script>

</body>
</html>
